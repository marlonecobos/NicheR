% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict.R
\name{predict.nicheR_ellipsoid}
\alias{predict.nicheR_ellipsoid}
\title{Predict Mahalanobis distance and suitability from a nicheR ellipsoid}
\usage{
\method{predict}{nicheR_ellipsoid}(
  object,
  newdata,
  adjust_level = NULL,
  include_suitability = TRUE,
  suitability_truncated = FALSE,
  include_mahalanobis = TRUE,
  mahalanobis_truncated = FALSE,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{object}{A \code{nicheR_ellipsoid} object produced by
\code{\link{build_ellipsoid}}. Must contain \code{dimensions},
\code{centroid}, \code{cov_matrix}, \code{Sigma_inv}, \code{chi2_cutoff}, and
\code{var_names}.}

\item{newdata}{Environmental data to predict to. Supported inputs are:
\code{terra::SpatRaster}, \code{raster::RasterLayer},
\code{raster::RasterStack}, \code{raster::RasterBrick},
\code{data.frame}, \code{tibble}, or \code{matrix}.}

\item{adjust_level}{Numeric scalar in (0, 1). Optional probability level used
to compute a new chi-square cutoff for truncated outputs.}

\item{include_suitability}{Logical; if \code{TRUE}, include suitability
\eqn{s(x)} in the output.}

\item{suitability_truncated}{Logical; if \code{TRUE}, include a truncated
suitability layer/column where values outside the chi-square cutoff are set
to 0 (and NA values remain NA).}

\item{include_mahalanobis}{Logical; if \code{TRUE}, include squared Mahalanobis
distance \eqn{D^2} in the output.}

\item{mahalanobis_truncated}{Logical; if \code{TRUE}, include a binary inside
mask for Mahalanobis distance at \code{adjust_level} (or object level if
\code{adjust_level} is \code{NULL}). Values are 1 for
\eqn{D^2 \le \chi^2_p(level)}, 0 otherwise (NA values remain NA).}

\item{verbose}{Logical; if \code{TRUE}, print brief progress messages.}

\item{...}{Additional arguments (currently unused).}
}
\value{
If \code{newdata} is a \code{terra::SpatRaster} (or a \code{raster::Raster*}
converted to \code{SpatRaster}), returns a multi-layer \code{SpatRaster}
containing the requested outputs.

If \code{newdata} is a \code{data.frame} or \code{matrix}, returns a
\code{data.frame} with the same number of rows as \code{newdata} and added
columns matching the requested outputs. Rows with missing predictor values
receive NA for numeric outputs.
}
\description{
Computes squared Mahalanobis distance \eqn{D^2} and a monotonic suitability
transform for new environmental data under a probabilistic ellipsoid niche.
The ellipsoid is defined by a multivariate normal (MVN) distribution with
mean vector \eqn{\mu} and inverse covariance matrix \eqn{\Sigma^{-1}} stored
in a \code{nicheR_ellipsoid} object.
}
\details{
The squared Mahalanobis distance is:
\deqn{
D^2(x) = (x - \mu)^T \Sigma^{-1} (x - \mu)
}

Suitability is computed as a convenient monotonic transform:
\deqn{
s(x) = \exp\left(-\frac{1}{2} D^2(x)\right)
}

A point is considered inside the ellipsoid at probability \code{cl} when:
\deqn{
D^2(x) \le \chi^2_p(\text{cl})
}
where \eqn{p} is the number of predictors (dimensions).

When \code{newdata} is a \code{terra::SpatRaster}, computations are performed
per cell and the function returns a multi-layer \code{SpatRaster}. When
\code{newdata} is a \code{data.frame} or \code{matrix}, the function returns a
\code{data.frame} with added output columns.
}
