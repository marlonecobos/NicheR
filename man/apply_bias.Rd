% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/apply_bias.R
\name{apply_bias}
\alias{apply_bias}
\title{Apply Sampling Bias to Suitability Surfaces}
\usage{
apply_bias(
  prepared_bias,
  prediction,
  effect_direction = "direct",
  verbose = TRUE
)
}
\arguments{
\item{prepared_bias}{A single-layer \code{terra::SpatRaster} composite bias
surface, or the list output returned by \code{\link{prepare_bias}} containing
\code{composite_surface}.}

\item{prediction}{A \code{terra::SpatRaster} containing one or more
suitability layers with values in \eqn{[0, 1]}.}

\item{effect_direction}{Character vector indicating how bias affects each
suitability layer. Options are \code{"direct"} or \code{"inverse"}.
A single value is recycled to match the number of suitability layers.
\code{"inverse"} applies \eqn{1 - bias} before multiplication.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages.}
}
\value{
A named list of class \code{"nicheR_biased_suitability"} containing:
\itemize{
  \item One element per input suitability layer, each a single-layer
  \code{terra::SpatRaster} of biased suitability (cropped and masked to the
  suitability domain). Elements are named \code{"<layer>_biased"} and the raster
  layer name includes the applied direction (e.g., \code{"<layer>_biased_direct"}).
  \item \code{combination_formula} Character vector (length = number of
  suitability layers) describing the operation applied to each layer
  (e.g., \code{"suitability * bias"} or \code{"suitability * (1-bias)"}).
}
}
\description{
Applies a prepared composite sampling bias surface to one or more suitability
rasters by multiplication. The bias surface is aligned to the suitability grid
when needed, optionally inverted per suitability layer, and the result is
cropped and masked to the suitability domain.
}
\details{
This function expects a single-layer composite bias surface (from
\code{\link{prepare_bias}}) and a \code{terra::SpatRaster} of suitability values
(typically the raster output from a prediction step). It performs the following:
\enumerate{
  \item Extracts a single-layer composite bias surface from \code{prepared_bias}.
  \item Verifies both bias and suitability values are within \eqn{[0, 1]}.
  \item Aligns the bias surface to the suitability grid if geometries differ
  (\code{terra::compareGeom()} + \code{terra::resample(method = "near")}).
  \item Applies the bias to each suitability layer via multiplication.
  \item Crops and masks each output layer to the suitability domain.
}

The output is a product of suitability and bias surfaces and therefore is not
interpretable as a probability.
}
\seealso{
\code{\link{prepare_bias}}
}
